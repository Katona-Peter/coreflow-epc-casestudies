

{% extends "base.html" %}
{% load cache %}

{% block content %}

<!-- Custom CSS for image hover effects -->
<style>
.case-study-image {
    transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
    cursor: pointer;
    will-change: transform;
}

.case-study-image:hover {
    transform: scale(1.05);
    box-shadow: 0 8px 16px rgba(0,0,0,0.3) !important;
}

.card-left {
    overflow: hidden;
    position: relative;
}

/* Ensure pagination is visible */
.pagination {
    margin: 2rem 0;
    padding: 1rem 0;
}
</style>

<!-- index.html content starts here -->
<div class="container-fluid" style="padding: 0 15px; margin-bottom: 2rem;">
    <div class="row">
        <div class="col-12 mt-3 left">
            <div class="row">
                {% cache 300 casestudy_list page_obj.number %}
                    {% for casestudy in casestudy_list %}
                    <div class="col-md-6 mb-4 d-flex">
                        {% load static %}
                        {% if casestudy.casestudyimage %}
                            <div class="card card-blue-margin h-100 w-100" style="background-image: url('{{ casestudy.casestudyimage.url }}'); background-size: cover; background-position: center; background-repeat: no-repeat;">
                        {% else %}
                            <div class="card card-blue-margin h-100 w-100" style="background-image: url({% static "images/default.png" %}); background-size: cover; background-position: center; background-repeat: no-repeat;">
                        {% endif %}
                            <!-- Layout with solid background left side and white right side -->
                            <div class="card-overlay" style="height: 100%; width: 100%; display: flex;">
                                <div class="card-left" style="flex: 0 0 50%; max-width: 50%; display: flex; align-items: flex-start; justify-content: center; padding: 0; height: 100%; overflow: hidden; background: rgba(255, 255, 255, 0.95);">
                                    <!-- Optimized image with priority loading for LCP improvement -->
                                    {% if forloop.first %}
                                        <picture>
                                            <source srcset="{% static 'images/electric-arc-furnace-eaf-expansion-project-lcp.webp' %}" type="image/webp">
                                            <img src="{% static 'images/electric-arc-furnace-eaf-expansion-project-lcp.webp' %}"
                                                 alt="Electric Arc Furnace EAF Expansion Project"
                                                 class="img-fluid case-study-image"
                                                 style="width: 100%; height: auto; display: block; margin: 0; border-radius: 8px 0 8px 0; box-shadow: 0 4px 8px rgba(0,0,0,0.2);"
                                                 loading="eager"
                                                 fetchpriority="high"
                                                 decoding="async"
                                                 width="400"
                                                 height="300">
                                        </picture>
                                    {% elif casestudy.casestudyimage and casestudy.casestudyimage != 'placeholder' %}
                                        <picture>
                                            <source srcset="{{ casestudy.casestudyimage.url|cut:'.png'|add:'.webp'|add:'?w=400&h=300&c=fill&q=auto&f=auto' }}" type="image/webp">
                                            <source srcset="{{ casestudy.casestudyimage.url|cut:'.png'|add:'.jpg'|add:'?w=400&h=300&c=fill&q=auto&f=auto' }}" type="image/jpeg">
                                            <img src="{{ casestudy.casestudyimage.url|add:'?w=400&h=300&c=fill&q=auto&f=auto' }}"
                                                 srcset="{{ casestudy.casestudyimage.url|add:'?w=320&h=240&c=fill&q=auto&f=auto' }} 320w, {{ casestudy.casestudyimage.url|add:'?w=400&h=300&c=fill&q=auto&f=auto' }} 400w, {{ casestudy.casestudyimage.url|add:'?w=600&h=450&c=fill&q=auto&f=auto' }} 600w, {{ casestudy.casestudyimage.url|add:'?w=800&h=600&c=fill&q=auto&f=auto' }} 800w"
                                                 sizes="(max-width: 576px) 90vw, (max-width: 768px) 45vw, 400px"
                                                 alt="{{ casestudy.title }} case study image"
                                                 class="img-fluid case-study-image"
                                                 style="width: 100%; height: auto; display: block; margin: 0; border-radius: 8px 0 8px 0; box-shadow: 0 4px 8px rgba(0,0,0,0.2);"
                                                 loading="lazy"
                                                 fetchpriority="low"
                                                 decoding="async"
                                                 width="400"
                                                 height="300">
                                        </picture>
                                    {% elif casestudy.casestudyimage and casestudy.casestudyimage != 'placeholder' %}
                                        <picture>
                                            <source srcset="{{ casestudy.casestudyimage.url|cut:'.png'|add:'.webp'|add:'?w=400&h=300&c=fill&q=auto&f=auto' }}" type="image/webp">
                                            <source srcset="{{ casestudy.casestudyimage.url|cut:'.png'|add:'.jpg'|add:'?w=400&h=300&c=fill&q=auto&f=auto' }}" type="image/jpeg">
                                            <img src="{{ casestudy.casestudyimage.url|add:'?w=400&h=300&c=fill&q=auto&f=auto' }}"
                                                 srcset="{{ casestudy.casestudyimage.url|add:'?w=320&h=240&c=fill&q=auto&f=auto' }} 320w, {{ casestudy.casestudyimage.url|add:'?w=400&h=300&c=fill&q=auto&f=auto' }} 400w, {{ casestudy.casestudyimage.url|add:'?w=600&h=450&c=fill&q=auto&f=auto' }} 600w, {{ casestudy.casestudyimage.url|add:'?w=800&h=600&c=fill&q=auto&f=auto' }} 800w"
                                                 sizes="(max-width: 576px) 90vw, (max-width: 768px) 45vw, 400px"
                                                 alt="{{ casestudy.title }} case study image"
                                                 class="img-fluid case-study-image"
                                                 style="width: 100%; height: auto; display: block; margin: 0; border-radius: 8px 0 8px 0; box-shadow: 0 4px 8px rgba(0,0,0,0.2);"
                                                 loading="lazy"
                                                 fetchpriority="low"
                                                 decoding="async"
                                                 width="400"
                                                 height="300">
                                        </picture>
                                    {% else %}
                                        <picture>
                                            <source srcset="{% static 'images/default.webp' %}" type="image/webp">
                                            <img src="{% static 'images/default.png' %}"
                                                 alt="Default case study image"
                                             class="img-fluid case-study-image"
                                             style="width: 100%; height: auto; display: block; margin: 0; border-radius: 8px 0 8px 0; box-shadow: 0 4px 8px rgba(0,0,0,0.2);"
                                             loading="{% if forloop.first %}eager{% else %}lazy{% endif %}"
                                             fetchpriority="{% if forloop.first %}high{% else %}low{% endif %}"
                                             decoding="async"
                                             width="400"
                                             height="300">
                                    </picture>
                                {% endif %}
                            </div>
                            <div class="card-right d-flex flex-column" style="flex: 0 0 50%; max-width: 50%; padding: 10px; display: flex; flex-direction: column; justify-content: center; height: 100%; background: rgba(255, 255, 255, 0.95);">
                                <div class="card-title-strip">
                                    <a href="{% url 'casestudy_detail' casestudy.slug %}" class="casestudy-link">                                                       
                                        <h2 style="font-family: 'Bebas Neue', sans-serif; font-weight: 400; letter-spacing: 1px;">{{ casestudy.title }}</h2>
                                    </a>                               
                                </div>   
                                <p class="flex-grow-1">{{ casestudy.excerpt }}</p>                         
                                <ul class="mt-auto">
                                    <li><strong><i class="fa fa-user" aria-hidden="true" style="display: inline-block; width: 20px; font-style: normal;"></i> Client:</strong> {{ casestudy.client }}</li>
                                    <li><strong><i class="fa fa-globe" aria-hidden="true" style="display: inline-block; width: 20px; font-style: normal;"></i> Location:</strong> {{ casestudy.location }}</li>
                                    <li><strong><i class="fa fa-industry" aria-hidden="true" style="display: inline-block; width: 20px; font-style: normal;"></i> Industry:</strong> {{ casestudy.industry }}</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
                {% endcache %}
            </div>
        </div>
    </div>
    {% if is_paginated %}
    <ul class="pagination justify-content-center">
        {% if page_obj.has_previous %}
            <li class="page-item">
                <a href="?page={{ page_obj.previous_page_number }}" class="page-link">&laquo; PREV</a>
            </li>
        {% endif %}
        {% if page_obj.has_next %}
            <li class="page-item">
                <a href="?page={{ page_obj.next_page_number }}" class="page-link">NEXT &raquo;</a>
            </li>
        {% endif %}
    </ul>
    {% endif %}
</div>

<!-- index.html content ends here -->
{% endblock %}